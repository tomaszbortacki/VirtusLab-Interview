{"version":3,"sources":["components/Loading.tsx","components/PersonMore.tsx","components/Person.tsx","App.tsx","api.ts","peopleReducer.ts","store.ts","index.tsx"],"names":["Loading","zoom","className","style","PersonMore","age","height","films","moviesList","useSelector","state","movies","useState","setMovies","loading","setLoading","dispatch","useDispatch","loadMovies","url","a","exists","length","reduce","selected","curr","path","name","prevState","axios","get","replace","window","location","protocol","then","res","data","title","type","payloads","movie","catch","err","console","error","fetchMovies","useEffect","map","key","Person","person","birth_year","gender","active","setActive","loadMore","setLoadMore","onClick","version","id","xmlns","x","y","viewBox","d","App","last","setLast","numberOf","setNumberOf","lock","setLock","people","addPerson","personID","addPeople","number","i","size","loadOnScroll","pageY","Math","ceil","pageYOffset","innerHeight","scrollHeight","document","documentElement","addEventListener","removeEventListener","Container","initalState","store","createStore","action","ReactDOM","render","StrictMode","getElementById"],"mappings":"qPAceA,EAZC,SAAC,GAAkB,IAAD,IAAfC,YAAe,MAAR,EAAQ,EAChC,OACE,qBAAKC,UAAU,mBAAmBC,MAAO,CAAEF,QAA3C,SACE,sBAAKC,UAAU,UAAf,UACE,wBACA,wBACA,8B,gBC2EOE,EAvEI,SAAC,GAAiD,IAA/CC,EAA8C,EAA9CA,IAAKC,EAAyC,EAAzCA,OAAQC,EAAiC,EAAjCA,MAC3BC,EAAaC,aACjB,SAACC,GAAD,OAAWA,EAAMC,UAF+C,EAKtCC,mBAAmB,IALmB,mBAK3DD,EAL2D,KAKnDE,EALmD,OAMpCD,oBAAkB,GANkB,mBAM3DE,EAN2D,KAMlDC,EANkD,KAQ5DC,EAAWC,cAEXC,EAAU,uCAAG,WAAOC,GAAP,eAAAC,EAAA,yDACbC,EAAiB,GAEjBb,EAAWc,OAAS,IACtBD,EAASb,EAAWe,QAClB,SAACC,EAAUC,GAAX,OAAqBA,EAAKC,OAASP,EAAMM,EAAKE,KAAOH,IACrD,MAIAH,EAVa,gBAULR,GAAU,SAACe,GAAD,4BAA6BA,GAA7B,CAAwCP,OAV7C,sCAYTQ,IACHC,IAAIX,EAAIY,QAAQ,QAASC,OAAOC,SAASC,WACzCC,MAAK,SAACC,GAAD,OAASA,EAAIC,QAClBF,MAAK,SAACE,GACL,IAAMC,EAAQD,EAAKC,MAEnBtB,EAAS,CACPuB,KAAM,YACNC,SAAU,CACRC,MAAO,CACLf,KAAMW,EAAKlB,IACXQ,KAAMU,EAAKC,UAIjBzB,GAAU,SAACe,GAAD,4BAA6BA,GAA7B,CAAwCU,UAEnDH,MAAK,eACLO,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,MA9BjB,2CAAH,sDAkCVG,EAAW,uCAAG,8CAAA1B,EAAA,2DAAOb,EAAP,+BAAyB,IAAzB,+BACWA,GADX,gEACIY,EADJ,iBACwBD,EAAWC,GADnC,8IAElBJ,GAAW,GAFO,gEAAH,qDASjB,OAJAgC,qBAAU,WACRD,EAAYvC,KACX,IAGD,yBAASL,UAAU,eAAnB,SACE,0BAASA,UAAU,eAAnB,UACE,uCAAUG,KACV,0CAAaC,KACb,yCAAYQ,EAAU,cAAC,EAAD,CAASb,KAAM,KAAU,MAC/C,6BACGU,EACGA,EAAOqC,KAAI,SAACP,EAAOQ,GACjB,OAAO,6BAAeR,GAANQ,MAElB,WCZCC,EA5DA,SAAC,GAAwC,IAAtCC,EAAqC,EAArCA,OACRxB,EAA4CwB,EAA5CxB,KAAMyB,EAAsCD,EAAtCC,WAAYC,EAA0BF,EAA1BE,OAAQ/C,EAAkB6C,EAAlB7C,OAAQC,EAAU4C,EAAV5C,MADW,EAGzBK,oBAAkB,GAHO,mBAG9C0C,EAH8C,KAGtCC,EAHsC,OAIrB3C,oBAAkB,GAJG,mBAI9C4C,EAJ8C,KAIpCC,EAJoC,KAMrD,OACE,0BAASvD,UAAWoD,EAAS,wBAA0B,SAAvD,UACE,qBACEpD,UAAU,iBACVwD,QAAS,WACPH,GAAWD,GACXG,GAAY,IAJhB,UAOE,qBAAInB,MAAOX,EAAX,UACE,yCACCA,KAEH,qBAAIW,MAAOc,EAAX,UACE,8CACCA,KAEH,qBAAId,MAAOe,EAAX,UACE,2CACCA,KAEH,6BACE,qBACEM,QAAQ,MACRC,GAAG,SACHC,MAAM,6BACNC,EAAE,MACFC,EAAE,MACFC,QAAQ,sBANV,SAQE,4BACE,sBACEC,EAAE,yYASXT,EACC,cAAC,EAAD,CACEnD,IAAK+C,EAAWrB,QAAQ,MAAO,IAC/BzB,OAAM,UAAKA,EAAL,MACNC,MAAOA,IAGT,OCuCO2D,MAvFf,WAAgB,IAAD,EACiBtD,oBAAkB,GADnC,mBACNE,EADM,KACGC,EADH,OAEWH,oBAAkB,GAF7B,mBAENuD,EAFM,KAEAC,EAFA,OAGmBxD,mBAAiB,GAHpC,mBAGNyD,EAHM,KAGIC,EAHJ,OAIW1D,oBAAkB,GAJ7B,mBAIN2D,EAJM,KAIAC,EAJA,KAMPC,EAAShE,aACb,SAACC,GAAD,OAAWA,EAAM+D,UAGbzD,EAAWC,cAEXyD,EAAS,uCAAG,WAAOC,GAAP,SAAAvD,EAAA,sEACVS,IACHC,IADG,UCvBU,yBDuBV,kBACiB6C,EADjB,MAEHxC,MAAK,SAACC,GAAD,OAASA,EAAIC,QAClBF,MAAK,SAACE,GACLrB,EAAS,CACPuB,KAAM,aACNC,SAAU,CACRW,OAAQd,KAGZ+B,GAAQ,MAET1B,OAAM,SAACC,GACNC,QAAQC,MAAMF,GACdyB,GAAQ,MAfI,2CAAH,sDAmBTQ,EAAS,uCAAG,4CAAAxD,EAAA,yDAAOyD,EAAP,+BAAgB,IAC5BV,EADY,iDAGhBpD,GAAW,GAIF+D,EAFHC,EAAOV,EALG,YAOGS,EAAIC,EAAOF,GAPd,iCAOiCH,EAAUI,GAP3C,OAOsBA,IAPtB,uBAQhBR,EAAYD,EAAWQ,GAEvB9D,GAAW,GAVK,4CAAH,qDAqCf,OAxBAgC,qBAAU,WACR6B,MACC,IAEH7B,qBAAU,WACR,IAAMiC,EAAY,uCAAG,8BAAA5D,EAAA,yDACb6D,EAAQC,KAAKC,KAAKnD,OAAOoD,YAAcpD,OAAOqD,aAC9CC,EAAeJ,KAAKC,KAAKI,SAASC,gBAAgBF,gBAEpDL,GAASK,IAAiBf,EAJX,uBAKjBC,GAAQ,GALS,SAMXI,EAAU,GANC,OAOjBJ,GAAQ,GAPS,2CAAH,qDAalB,OAFAxC,OAAOyD,iBAAiB,QAAST,GACjChD,OAAOyD,iBAAiB,YAAaT,GAC9B,WACLhD,OAAO0D,oBAAoB,QAASV,GACpChD,OAAO0D,oBAAoB,YAAaV,MAEzC,CAACX,EAAUE,IAGZ,yBAASrE,UAAU,OAAnB,SACE,eAACyF,EAAA,EAAD,WACE,yBAASzF,UAAU,YAAnB,SACE,uDAEF,0BAASA,UAAU,aAAnB,UACGuE,EACGA,EAAOzB,KAAI,SAACG,EAAQF,GAClB,OAAO,cAAC,EAAD,CAAQE,OAAQA,GAAaF,MAEtC,GACHnC,EAAU,cAAC,EAAD,IAAc,Y,wBExE7B8E,EAAc,CAClBnB,OAAQ,GACR9D,OAAQ,ICjBGkF,EAAQC,aD4BQ,WAGvB,IAFJpF,EAEG,uDAFkBkF,EACrBG,EACG,uCACH,OAAQA,EAAOxD,MACb,IAAK,aAAe,IAAD,EAObwD,EAAOvD,SAASW,OALlBxB,EAFe,EAEfA,KACAyB,EAHe,EAGfA,WACAC,EAJe,EAIfA,OACA/C,EALe,EAKfA,OACAC,EANe,EAMfA,MAEF,OAAO,2BACFG,GADL,IAEE+D,OAAO,GAAD,mBACD/D,EAAM+D,QADL,CAEJ,CACE9C,OACAyB,aACAC,SACA/C,SACAC,aAKR,IAAK,YAAc,IAAD,EACOwF,EAAOvD,SAASC,MAA/Bf,EADQ,EACRA,KAAMC,EADE,EACFA,KAEd,OAAO,2BACFjB,GADL,IAEEC,OAAO,GAAD,mBACDD,EAAMC,QADL,CAEJ,CACEe,OACAC,YAKR,QACE,OAAOjB,MEhEbsF,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,IAAD,CAAUL,MAAOA,EAAjB,SACE,cAAC,EAAD,QAGJN,SAASY,eAAe,W","file":"static/js/main.66cf53e0.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nconst Loading = ({ zoom = 1 }) => {\r\n  return (\r\n    <div className=\"loading__wrapper\" style={{ zoom }}>\r\n      <div className=\"loading\">\r\n        <div></div>\r\n        <div></div>\r\n        <div></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Loading;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { PeopleState } from \"../peopleReducer\";\r\nimport Loading from \"./Loading\";\r\nimport axios from \"axios\";\r\n\r\ninterface PersonMoreInterface {\r\n  age: string;\r\n  height: string;\r\n  films: string[];\r\n}\r\n\r\nconst PersonMore = ({ age, height, films }: PersonMoreInterface) => {\r\n  const moviesList = useSelector<PeopleState, PeopleState[\"movies\"]>(\r\n    (state) => state.movies\r\n  );\r\n\r\n  const [movies, setMovies] = useState<string[]>([]);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const loadMovies = async (url: string) => {\r\n    let exists: string = \"\";\r\n\r\n    if (moviesList.length > 0) {\r\n      exists = moviesList.reduce(\r\n        (selected, curr) => (curr.path === url ? curr.name : selected),\r\n        \"\"\r\n      );\r\n    }\r\n\r\n    if (exists) setMovies((prevState: string[]) => [...prevState, exists]);\r\n    else {\r\n      await axios\r\n        .get(url.replace(\"http:\", window.location.protocol))\r\n        .then((res) => res.data)\r\n        .then((data) => {\r\n          const title = data.title;\r\n\r\n          dispatch({\r\n            type: \"ADD_MOVIE\",\r\n            payloads: {\r\n              movie: {\r\n                path: data.url,\r\n                name: data.title,\r\n              },\r\n            },\r\n          });\r\n          setMovies((prevState: string[]) => [...prevState, title]);\r\n        })\r\n        .then(() => {})\r\n        .catch((err) => console.error(err));\r\n    }\r\n  };\r\n\r\n  const fetchMovies = async (films: string[] = []) => {\r\n    if (films) for (const url of films) await loadMovies(url);\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchMovies(films);\r\n  }, []);\r\n\r\n  return (\r\n    <section className=\"person__more\">\r\n      <section className=\"person__desc\">\r\n        <h3>Age: {age}</h3>\r\n        <h3>Height: {height}</h3>\r\n        <h3>Films: {loading ? <Loading zoom={0.4} /> : \"\"}</h3>\r\n        <ul>\r\n          {movies\r\n            ? movies.map((movie, key) => {\r\n                return <li key={key}>{movie}</li>;\r\n              })\r\n            : \"\"}\r\n        </ul>\r\n      </section>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default PersonMore;\r\n","import React, { useState } from \"react\";\r\nimport { PersonType } from \"../peopleReducer\";\r\nimport PersonMore from \"./PersonMore\";\r\n\r\nconst Person = ({ person }: { person: PersonType }) => {\r\n  const { name, birth_year, gender, height, films } = person;\r\n\r\n  const [active, setActive] = useState<boolean>(false);\r\n  const [loadMore, setLoadMore] = useState<boolean>(false);\r\n\r\n  return (\r\n    <section className={active ? \"person person--active\" : \"person\"}>\r\n      <ul\r\n        className=\"person__basics\"\r\n        onClick={() => {\r\n          setActive(!active);\r\n          setLoadMore(true);\r\n        }}\r\n      >\r\n        <li title={name}>\r\n          <span>Name:</span>\r\n          {name}\r\n        </li>\r\n        <li title={birth_year}>\r\n          <span>Birth year</span>\r\n          {birth_year}\r\n        </li>\r\n        <li title={gender}>\r\n          <span>Gender:</span>\r\n          {gender}\r\n        </li>\r\n        <li>\r\n          <svg\r\n            version=\"1.1\"\r\n            id=\"Capa_1\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            x=\"0px\"\r\n            y=\"0px\"\r\n            viewBox=\"0 0 512.171 512.171\"\r\n          >\r\n            <g>\r\n              <path\r\n                d=\"M479.046,283.925c-1.664-3.989-5.547-6.592-9.856-6.592H352.305V10.667C352.305,4.779,347.526,0,341.638,0H170.971\r\n\t\t\tc-5.888,0-10.667,4.779-10.667,10.667v266.667H42.971c-4.309,0-8.192,2.603-9.856,6.571c-1.643,3.989-0.747,8.576,2.304,11.627\r\n\t\t\tl212.8,213.504c2.005,2.005,4.715,3.136,7.552,3.136s5.547-1.131,7.552-3.115l213.419-213.504\r\n\t\t\tC479.793,292.501,480.71,287.915,479.046,283.925z\"\r\n              />\r\n            </g>\r\n          </svg>\r\n        </li>\r\n      </ul>\r\n      {loadMore ? (\r\n        <PersonMore\r\n          age={birth_year.replace(\"BBY\", \"\")}\r\n          height={`${height}cm`}\r\n          films={films}\r\n        />\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Person;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport \"./css/style.scss\";\r\nimport { Container } from \"react-bootstrap\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { PeopleState } from \"./peopleReducer\";\r\nimport axios from \"axios\";\r\nimport api from \"./api\";\r\nimport Loading from \"./components/Loading\";\r\nimport Person from \"./components/Person\";\r\n\r\nfunction App() {\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [last, setLast] = useState<boolean>(false);\r\n  const [numberOf, setNumberOf] = useState<number>(1);\r\n  const [lock, setLock] = useState<boolean>(false);\r\n\r\n  const people = useSelector<PeopleState, PeopleState[\"people\"]>(\r\n    (state) => state.people\r\n  );\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const addPerson = async (personID: number) => {\r\n    await axios\r\n      .get(`${api}people/${personID}/`)\r\n      .then((res) => res.data)\r\n      .then((data) => {\r\n        dispatch({\r\n          type: \"ADD_PERSON\",\r\n          payloads: {\r\n            person: data,\r\n          },\r\n        });\r\n        setLast(false);\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n        setLast(true);\r\n      });\r\n  };\r\n\r\n  const addPeople = async (number = 10) => {\r\n    if (last) return;\r\n\r\n    setLoading(true);\r\n\r\n    const size = numberOf;\r\n\r\n    for (let i = size; i < size + number; i++) await addPerson(i);\r\n    setNumberOf(numberOf + number);\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    addPeople();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const loadOnScroll = async () => {\r\n      const pageY = Math.ceil(window.pageYOffset + window.innerHeight);\r\n      const scrollHeight = Math.ceil(document.documentElement.scrollHeight);\r\n\r\n      if (pageY >= scrollHeight && !lock) {\r\n        setLock(true);\r\n        await addPeople(5);\r\n        setLock(false);\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"wheel\", loadOnScroll);\r\n    window.addEventListener(\"touchmove\", loadOnScroll);\r\n    return () => {\r\n      window.removeEventListener(\"wheel\", loadOnScroll);\r\n      window.removeEventListener(\"touchmove\", loadOnScroll);\r\n    };\r\n  }, [numberOf, lock]);\r\n\r\n  return (\r\n    <section className=\"main\">\r\n      <Container>\r\n        <section className=\"main__top\">\r\n          <h1>Star Wars Challenge</h1>\r\n        </section>\r\n        <section className=\"main__list\">\r\n          {people\r\n            ? people.map((person, key) => {\r\n                return <Person person={person} key={key} />;\r\n              })\r\n            : \"\"}\r\n          {loading ? <Loading /> : \"\"}\r\n        </section>\r\n      </Container>\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const api: string = \"https://swapi.dev/api/\";\r\nexport default api;\r\n","export type PersonType = {\r\n  name: string;\r\n  birth_year: string;\r\n  gender: string;\r\n  height: string;\r\n  films: string[];\r\n};\r\n\r\nexport type MoviesType = {\r\n  path: string;\r\n  name: string;\r\n};\r\n\r\nexport interface PeopleState {\r\n  people: Array<PersonType>;\r\n  movies: Array<MoviesType>;\r\n}\r\n\r\nconst initalState = {\r\n  people: [],\r\n  movies: [],\r\n};\r\n\r\ntype Action = {\r\n  type: string;\r\n  payloads: {\r\n    person: PersonType;\r\n    movie: MoviesType;\r\n  };\r\n};\r\n\r\nexport const peopleReducer = (\r\n  state: PeopleState = initalState,\r\n  action: Action\r\n) => {\r\n  switch (action.type) {\r\n    case \"ADD_PERSON\": {\r\n      const {\r\n        name,\r\n        birth_year,\r\n        gender,\r\n        height,\r\n        films,\r\n      } = action.payloads.person;\r\n      return {\r\n        ...state,\r\n        people: [\r\n          ...state.people,\r\n          {\r\n            name,\r\n            birth_year,\r\n            gender,\r\n            height,\r\n            films,\r\n          },\r\n        ],\r\n      };\r\n    }\r\n    case \"ADD_MOVIE\": {\r\n      const { path, name } = action.payloads.movie;\r\n\r\n      return {\r\n        ...state,\r\n        movies: [\r\n          ...state.movies,\r\n          {\r\n            path,\r\n            name,\r\n          },\r\n        ],\r\n      };\r\n    }\r\n    default: {\r\n      return state;\r\n    }\r\n  }\r\n};\r\n","import { createStore } from \"redux\";\r\nimport { peopleReducer } from \"./peopleReducer\";\r\n\r\nexport const store = createStore(peopleReducer);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\n// Import react-redux\r\nimport { Provider } from \"react-redux\";\r\nimport { store } from \"./store\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}